<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>小米账号-注册</title>
    <link rel="icon" href="../images/til.ico" type="image/x-icon">
    <link rel="stylesheet" href="../css/reset.css">
    <link rel="stylesheet" href="../css/res.css">
    <link rel="stylesheet" href="../fonts/iconfont.css">
</head>
<div class="header_title">
    <div class="header_ticon">
        <ul>
            <li>
                <a href="../index.html">
                    <img src="../images/login_lg.png" alt="">
                </a>
            </li>
            <li><a href="../index.html">小米商城</a></li>
        </ul>
    </div>
</div>

<div class="headers">

    <div class="headers_let">
        <button><span class="iconfont icon-weixin"></span>手机号注册</button>
        <button><span class="iconfont icon-qq"></span>邮件地址注册</button>
    </div>
    <div class="headers_rig flex_clear">
        <h2>小米账号注册</h2>
        <h3>已有账号 <a href="./login.html">去登陆&gt;</a></h3>
        <div class=" head_inp">
            <form action="">
                <input type="text" placeholder="手机号/邮箱/小米账号"><br>
                <input type="password" placeholder="密码"><br>
                <input type="password" placeholder="确认密码"><br>
                <input type="text" placeholder="校验码"><span>123456</span><br>
                <input type="submit" value="注册"><br>
            </form>
        </div>
    </div>




</div>

<div class="footers">
    <div class="foot_con">
        <ul>
            <!-- 华为帐号与云空间用户协议 | 关于华为帐号与云空间隐私的声明 | 常见问题 | Cookies -->
            <li>
                <a href="">华为帐号与云空间用户协议 | </a>
            </li>
            <li>
                <a href="">关于华为帐号与云空间隐私的声明 | </a>
            </li>
            <li>
                <a href="">常见问题 | </a>
            </li>
            <li>
                <a href="">Cookies | </a>
            </li>
        </ul>
        <p>Copyright © 2011-2020 华为软件技术有限公司 版权所有 保留一切权利 苏B2-20070200号 | 苏ICP备09062682号-9</p>
    </div>
</div>

<script src="../jquery.min.js"></script>
<script src="../js/tools.js"></script>
<script>
    let oSubmit = document.querySelector('form input:last-of-type');
    let oInputName = document.querySelector('form input:first-of-type');
    let oInputPwd = document.querySelector('form input:nth-of-type(2)');
    let oInputPwd2 = document.querySelector('form input:nth-of-type(3)');
    let oInputNum = document.querySelector('form input:nth-of-type(4)');
    const oForm = document.querySelector('form');
    let oSpan = document.querySelector('form span');
    oSpan.innerHTML = setRandomNum();
    oSpan.style.color = setRandomColor();
    oSpan.addEventListener('click', () => {
        oSpan.innerHTML = setRandomNum();
        oSpan.style.color = setRandomColor();
    })

    // oForm.addEventListener('submit', e => {
    //     e = e || window.event;
    //     if (e.preventDefault) {
    //         console.log('asdsa');
    //         return e.preventDefault();
    //     } else {
    //         e.returnValue = true;
    //     }
    // });
    let userName = oInputName.value;
    let userPwd = oInputPwd.value;
    let userPwd2 = oInputPwd2.value;
    if (userName === '' || userPwd == "" || userPwd2 == "") {
        oSubmit.style.opacity = '0.5';
    }
    oSubmit.onclick = function() {
        oForm.addEventListener('submit', e => {
            e = e || window.event;
            if (e.preventDefault) {
                e.preventDefault();
            } else {
                e.returnValue = true;
            }
        });
        let userName = oInputName.value;
        let userPwd = oInputPwd.value;
        let userPwd2 = oInputPwd2.value;
        if (userName === '' || userPwd == "" || userPwd2 == "") {
            oSubmit.style.opacity = '0.5';
        }
        let nums = oInputNum.value.toUpperCase();
        let str = oSpan.innerText.toUpperCase();
        if (userPwd != userPwd2) {
            window.history.go(0)
            window.confirm('密码不一致请重新输入');
        }
        if (nums != str) {
            window.history.go(0)
            window.confirm('验证码不一致请重新输入');
        }
        $.ajax({
            url: '../server/xm_res.php',
            type: 'post',
            data: {
                userName: userName,
                userPwd: userPwd
            },
            dataType: 'json',
            success: result => {
                if (result.res === 1) {
                    window.alert('注册成功,点击确定,跳转首页面')
                    window.location.href = '../index.html';

                } else {
                    window.alert('注册失败,用户名重复,请您重新设定用户名,玩命继续注册');
                }
            }
        })
    }
</script>

<body>

</body>

</html>